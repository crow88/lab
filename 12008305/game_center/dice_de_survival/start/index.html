<!doctype html>
<html lang="ja" xml:lang="ja">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="pragma" content="no-cache">
    <meta http-equiv="cache-control" content="no-cache">
    <meta http-equiv="expires" content="-1">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1, maximum-scale=1, minimal-ui">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="mobage: footer-color" content="none">
    <link rel="stylesheet" href='../../../../12008305/css/game/pex.css' media="all">
    <script src='../../../../12008305/js/jquery-1.9.1.min.js'></script>
    <script src='../../../../12008305/js/pex-1.2.0.js'></script>
    <script src='../../../../12008305/js/pex_common.js'></script>
    <title>ｱｲﾄﾞﾙﾏｽﾀｰ ｼﾝﾃﾞﾚﾗｶﾞｰﾙｽﾞ </title>
    <script type="text/javascript">
        var flag = false;
        addEventListener("DOMContentLoaded", function() {
            setTimeout(hideURLbar, 100);
        }, false);

        function hideURLbar() {
            if (window.pageYOffset === 0) {
                window.scrollTo(0, 1);
                // スクロールバー対応後、再度marginTopを設定
                var isTouch = ('ontouchstart' in window);
                var isSp = false;
                if (isTouch === false) isSp = false;
                else if (window.orientation === undefined) isSp = false;
                else isSp = true;
                displayScaleValue = scaleSizeCheck();
                var width = 240 * displayScaleValue * 2;
                marginLeft = widthMarginCheck(displayScaleValue);
                marginTop = topMarginCheck(displayScaleValue);
                var container = document.getElementById("container");
                container.setAttribute("style", "margin-left:" + (marginLeft) + "px");
                container.style.marginTop = (marginTop) + "px";
                container.style.zoom = "50%";
                container.style.minHeight = "481px";
            }
        }
        var isTouch = ('ontouchstart' in window);
        var isSp = false;
        if (isTouch === false) isSp = false;
        else if (window.orientation === undefined) isSp = false;
        else isSp = true;
        displayScaleValue = scaleSizeCheck();
        var width = 240 * displayScaleValue * 2;
        marginLeft = widthMarginCheck(displayScaleValue);
        marginTop = topMarginCheck(displayScaleValue);
        window.onunload = function() {};
        window.onload = function() {
            window.game_center_obj = new GameCenter();
            window.scrollTo(0, 1);
            timerId = setTimeout("isFlash()", 60000);
        };

        function touchHandler(event) {
            event.preventDefault();
        };

        function redirect() {
            location.href = "https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http:/mobamas.net/idolmaster/error%3Fl_frm%3DSmart_phone_flash_convert_game_center_1%26rnd%3D53511105";
        };

        function isFlash() {
            var container = document.getElementById("container");
            var children = container.childNodes;
            if (children.length < 1) {
                redirect();
            } else {
                clearTimeout(timerId);
            }
        };

        function scaleSizeCheck() {
            window.scrollTo(0, 1);
            myW = window.innerWidth;
            myH = window.innerHeight;
            scaleWidth = myW / 240;
            scaleHeight = myH / 320;
            if (myH > myW) {
                myS = scaleWidth;
            } else {
                myS = scaleHeight;
            }
            return myS;
        };

        function widthMarginCheck(scale) {
            if (scale < 0) {
                return 0;
            }
            baseW = 240;
            myW = window.innerWidth;
            size = baseW * scale;
            if ((myW - size) < 5) {
                marginL = 0;
            } else {
                marginL = Math.round((myW - size) / 2);
            }
            return marginL * 2;
        };

        function topMarginCheck(scale) {
            if (scale < 0) {
                return 0;
            }
            baseH = 320;
            myH = window.innerHeight;
            size = baseH * scale;
            if ((myH - size) < 5) {
                marginT = 0;
            } else {
                marginT = Math.round((myH - size) / 2);
            }
            return marginT * 2;
        };

        function GameCenter() {
            this.pex = false;
            this.pexApi = false;
            this.init();
        };
        GameCenter.prototype.init = function() {
            var container = document.getElementById("container")
            container.setAttribute("style", "margin-left:" + (marginLeft) + "px");
            container.style.marginTop = (marginTop) + "px";
            container.style.zoom = "50%";
            container.style.minHeight = "481px";
            var option = {
                enableButton: true,
                enableTouch: true,
                partialDraw: getPexPartialDraw(),
                delayEval: false,
                stopOnStart: true,
                operation: {
                    lighter_tgt: "lighter"
                },
                width: width
            };
            option['frameCallback'] = {
                '/sound_mc': {
                    'chara_flash_se': function() {
                        se_play('se_107');
                    },
                    'furidasi_se': function() {
                        se_play('se_084');
                    },
                    'battle_se': function() {
                        se_play('se_135');
                    },
                    'ba_ex_se': function() {
                        se_play('se_023');
                    },
                    'sachiko_se': function() {
                        se_play('se_079');
                    },
                    'sachiko_light_se': function() {
                        se_play('se_145');
                    },
                    'window1_se': function() {
                        se_play('se_110');
                    },
                    'window2_se': function() {
                        se_play('se_042');
                    },
                    'win_light_se': function() {
                        se_play('se_022');
                    },
                    'level_up_se': function() {
                        se_play('se_077');
                    },
                    'treasure_get_se': function() {
                        se_play('se_064');
                    },
                    'treasure_failure_se': function() {
                        se_play('se_003');
                    },
                    'live_start_se': function() {
                        se_play('se_122');
                    },
                    'dice_throw_se': function() {
                        se_play('se_011');
                    },
                    'dice_drop_se': function() {
                        se_play('se_102');
                    },
                    'select_se': function() {
                        se_play('se_005');
                    },
                    'chara_se': function() {
                        se_play('se_117');
                    },
                    'walk_se': function() {
                        se_play('se_102');
                    },
                    'light_up_se': function() {
                        se_play('se_130');
                    },
                    'attack_se': function() {
                        se_play('se_044');
                    },
                    'heal_se': function() {
                        se_play('se_108');
                    },
                    'nexstage_se': function() {
                        se_play('se_044');
                    },
                    'tres_gover_se': function() {
                        se_play('se_048');
                    },
                    'boss_behave_se': function() {
                        se_play('se_045');
                    },
                    'strength_up_se': function() {
                        se_play('se_104');
                    },
                    'defense_up_se': function() {
                        se_play('se_116');
                    },
                },
            };
            this.runPex(option);
        };
        GameCenter.prototype.runPex = function(option) {
            this.pex = new Pex('https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http:/mobamas.net/idolmaster/game_center/dice_de_survival_play/72699359%3FflashParam%3D454833207%26l_frm%3DSmart_phone_flash_convert_game_center_1%26rnd%3D572508932', "container", option);
            this.api = this.pex.getAPI();
            this.api.ready(function() {
                game_center_obj.pexEngineStart();
            });
        };
        GameCenter.prototype.pexEngineStart = function() {
            this.api.engineStart();
        };
        GameCenter.prototype.submitAjax = function(jsonStr) {
            var self = this;


            $.ajax({
                type: 'post',
                url: 'https://sp.pf.mbga.jp/12008305/?guid=ON&amp;url=http:/mobamas.net/idolmaster/game_center/dice_de_survival_ajax_api%3Fparty_hash%3D421aeec5ea3313f1079a272970d0da51430d618ef13731d1c2fa2e1723236789%26l_frm%3DSmart_phone_flash_convert_game_center_1%26rnd%3D789282749',
                dataType: 'json',
                headers: {
                    "Pragma": "no-cache"
                },
                data: {
                    'game_code': 'dice_de_survival',
                    'play_id': 72699359,
                    'parent_play_id': 7886666,
                    'json': jsonStr
                },
                timeout: 3000,
                success: function(data) {

                    self.api.callActions("/", "connectSuccess");
                    flag = false;
                },
                error: function(data) {
                    self.api.callActions("/", "connectError");
                    flag = false;

                }
            });
        };

        function connectData(accessKey, jsonStr) {
            if (flag) return;
            flag = true;

            game_center_obj.submitAjax(jsonStr);
        }
    </script>
    <script type='text/javascript'>
        var se_flg = 0,
            bgm_flg = 0,
            chrome_app_flg = 0,
            chrome_app_extension_id = 'dnacabmnfmejgfffmcehejcmiciinpej';
    </script>
    <script type='text/javascript' src='../../../../12008305/js/app_sound.js'></script>
    <link rel="stylesheet" type="text/css" href="../../../../css/base.css" />
</head>

<body style="height:100%">
    <div id="container"></div>
</body>

</html>
<script type="text/javascript">
    console.log = function() {};
</script>